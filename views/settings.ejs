<div class="row mt-7">
  <div class="col-md-6 m-auto">
    <div class="card card-body">
      <h1 class="text-center mb-3">
        <i class="fas fa-profile"></i><%=linkInfo.user_name%>`s settings
      </h1>
      <form action="/settings/save" method="POST">
        <div class="form-group">
          <label for="user_name">User name</label>
          <input
            onkeyup="changed()"
            type="text"
            id="user_name"
            name="user_name"
            class="form-control"
            value="<%=linkInfo.user_name%>"
            placeholder="Enter new user name"
            required
          />
        </div>
        <div class="form-group">
          <label for="email">Email</label>
          <input
            onkeyup="changed()"
            type="email"
            id="email"
            name="email"
            class="form-control"
            placeholder="Enter Email"
            value="<%=linkInfo.e_mail%>"
            required
          />
        </div>
        <div class="form-group">
          <label for="password">New password</label>
          <input
            onkeyup="changed()"
            type="password"
            id="password"
            name="password"
            class="form-control"
            placeholder="Enter Password"
            value="<%=linkInfo.password%>"
            minlength="6"
            required
          />
        </div>
        <div class="form-check">
          <input
            onclick="showIfChanged()"
            type="checkbox"
            class="form-check-input"
            id="exampleCheck1"
          />
          <label class="form-check-label" for="exampleCheck1"
            >Show password</label
          >
        </div>
        <br />
        <div class="row">
          <div class="col-sm text-center">
            <button
              id="save"
              disabled
              type="submit"
              class="btn btn-primary btn-block"
            >
              Save settings
            </button>
          </div>
          <div class="col-sm text-center">
            <a href="/" class="btn btn-secondary btn-block mb-2">Home</a>
          </div>
        </div>
      </form>
    </div>
  </div>
</div>

<script>
  let initState = {
    user_name: document.getElementById("user_name").value,
    e_mail: document.getElementById("email").value,
    password: document.getElementById("password").value
  };

  let newState = {};

  function changed() {
    newState = {
      user_name: document.getElementById("user_name").value,
      e_mail: document.getElementById("email").value,
      password: document.getElementById("password").value
    };
    console.log(newState, initState);
    if (
      newState.user_name == initState.user_name &&
      newState.e_mail == initState.e_mail &&
      newState.password == initState.password
    ) {
      document.getElementById("save").setAttribute("disabled", "");
    } else {
      document.getElementById("save").removeAttribute("disabled");
    }
  }

  function showIfChanged() {
    var passEl = document.getElementById("password");
    if (passEl.type === "password") {
      passEl.type = "text";
    } else {
      passEl.type = "password";
    }
  }
</script>
